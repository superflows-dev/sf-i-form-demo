<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>&lt;sf-i-sub-select&gt; Demo</title>
        <!-- Integration material icons as they are used in sf-nav -->
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <!-- Google fonts integration -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@200;300;400;600&display=swap" rel="stylesheet">
        <!-- Add all the custom styling in this css file -->
        <link rel="stylesheet" href="styles.css">
        <script src="./util.js"></script>
        <!-- Integration the web components module -->
        <!-- Integration lit and sf-nav web components module -->
        <script type="module">
            import {LitElement, html, css} from 'https://unpkg.com/lit-element/lit-element.js?module';
        </script>
    </head>

    <body>

        <br /><br />
        <div class="logo-container">
            <a href="index.html"><img src="https://superflows-images.s3.ap-south-1.amazonaws.com/superflows_black_transparent_200.png" /></a>
        </div>
        <div class="logo-container">
            <h1>MOD_NAME</h1>
        </div>

        <div class="logo-container">
            <span class="badge">Sample Code</span>
        </div>

        <div class="ui-container user">
            <div><h4>You are signed in as</h4></div>
            <div><h2 class="user-email"></h2></div>
            <button onclick="signOut()">Sign Out</button>
            <br />
            <br />
        </div>

        <div class="ui-container auth">
            <div><h4>You are not signed in</h4></div>
            <button onclick="signIn()">Sign In</button>
        </div>   

        <div class="logo-container">
            <div class="lc"></div>
            <div class="grow text-center">
                <button class="admin" onclick="window.location.href='form.html'"><h2>View Form</h2></button>
            </div>
            <div class="rc"></div>
        </div>
        
        <div class="info-container">

            <h2>Purpose</h2>
            The purpose of this sample code is to give you a boilerplate along with a ready-to-be-consumed integration with the form supermod. This code uses three supermods - (1) sf-user-auth, which is the authentic supermod and (2) sf-i-select, which is the select input supermod and (3) sf-i-sub-select, which is the dependent select input supermod. 
            
            Please feel free to copy this code and use it in your app.

            <h2>Code Structure</h2>
            The code consists of the following files:

            <h3>index.html</h3>
            <ul>
                <li>This file functions as the entry point of the sample app</li>
                <li>It is simply a wrapper for the authentication functionality</li>
                <li>If the user is signed in, the sign in information is shown, and link to the form page is shown as well</li>
                <li>If the signed in user is an administrator, a button to the admin console of the select input supermod is shown</li>
                <li>If the user is not signed in, a link to the sign in page is shown</li>
            </ul> 

            <h3>auth.html</h3>
            <ul>
                <li>This file integrates the authentication supermod</li>
                <li>It handles the sign in and sign out events as well</li>
            </ul> 

            <h3>form.html</h3>
            <ul>
                <li>This file wraps the form functionality</li>
            </ul> 
    
            <h3>styles.css</h3>
            <ul>
                <li>Custom css styles are specified in this css stylesheet</li>
            </ul> 

            <h3>util.js</h3>
            <ul>
                <li>This javascript file contains some simple utilities</li>
            </ul> 

            <h2>SfIForm Usage</h2>

            <h3>Step 1 - Configure the backend</h3>

            <ul>
                <li>Go to <a href="https://console.superflows.com">Superflows Console</a></li>
                <li>Sign into your account / Create a new account</li>
                <li>Create a new supermod, choose sf-i-form as the type</li>
                <li>Create a new deployment, consume it in the frontend code after it is deployed and ready for use</li>
            </ul>

            <h3>Step 2 - Configure the frontend</h3>

            <ul>
                <li>Use this sample code as reference and modify your frontend code accordingly</li>
                <li>This sample code uses the sf-i-form webcomponents, which is available for free on npm</li>
            </ul>

            <h2>sf-i-form webcomponent</h2>

            Following props are provided by the sf-i-form webcomponent:

            <ul>
                <li><b>name</b> - name of the form</li>
                <li><b>apiId</b> - apiId of the deployment</li>
                <li><b>dependencies</b> - dropdown dependencies</li>
                <li><b>inputs</b> - array of input element ids</li>
                <li><b>fields</b> - array of input fields</li>
                <li><b>selectedId</b> - id of the selected record item</li>
                <li><b>mode</b> - view / new / detail / trail</li>
            </ul>

            <h2>Resources</h2>

            <h3>Superflows Console</h3>
            <a href="https://superflows.dev">Sign In</a>

            <h3>YouTube Channel</h3>
            <a href="https://www.youtube.com/channel/UCYNJLCE48yir4DsquciBuDw">Subscribe</a>

            <h3>Questions?</h3>
            <a href="https://discord.gg/ksEXS4P9h6">Join the community</a>

        </div>

        <script>

            function signOut() {
                window.location.href = 'auth.html#auth/signout';
            }

            function signIn() {
                window.location.href = 'auth.html#auth/signin';
            }

            function init() {

                const email = readCookie('email');
                const admin = readCookie('admin');

                console.log(email, admin);
                
                if(email == null || email.length == 0) {

                    console.log('email null',document.querySelector('.admin'));
                    
                    document.querySelector('.auth').style.display = 'flex';
                    document.querySelector('.user').style.display = 'none';
                    document.querySelector('.admin').style.display = 'none';
                
                } else {

                    document.querySelector('.user-email').innerHTML = email;
                    document.querySelector('.user').style.display = 'flex';
                    document.querySelector('.auth').style.display = 'none';

                    if(admin == "true") {

                        document.querySelector('.admin').style.display = 'inline';

                    } else {
                        
                        document.querySelector('.admin').style.display = 'none';

                    }

                }

            }

            init();

        </script>

    </body>
  
</html>